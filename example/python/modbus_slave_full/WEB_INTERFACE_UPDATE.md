# Web 界面功能码显示更新

## 更新内容

Web 控制台的统计信息页面现在完整显示所有 18 个功能码，包括高级功能码和文件记录操作。

### 已实现的功能

#### 1. 功能码中文名称显示

所有功能码现在都显示完整的中文名称：

- **FC01** - 读线圈
- **FC02** - 读离散输入
- **FC03** - 读保持寄存器
- **FC04** - 读输入寄存器
- **FC05** - 写单个线圈
- **FC06** - 写单个寄存器
- **FC07** - 读异常状态
- **FC08** - 诊断
- **FC11** - 获取通信事件计数器
- **FC12** - 获取通信事件日志
- **FC15** - 写多个线圈
- **FC16** - 写多个寄存器
- **FC17** - 报告从站ID
- **FC20** - 读文件记录 ⭐
- **FC21** - 写文件记录 ⭐
- **FC22** - 屏蔽写寄存器
- **FC23** - 读写多个寄存器
- **FC24** - 读FIFO队列

#### 2. 表格改进

- ✅ 功能码按编号自动排序
- ✅ 添加表格滚动支持（最大高度500px）
- ✅ 表头固定，内容可滚动
- ✅ 隔行变色，提升可读性
- ✅ 鼠标悬停高亮效果
- ✅ 空数据时显示友好提示
- ✅ 深色模式适配

#### 3. 样式优化

```css
/* 新增样式特性 */
- 表格包装器支持水平和垂直滚动
- 表头粘性定位，始终可见
- 行悬停效果增强
- 隔行颜色区分
- 响应式设计
```

### 使用方法

1. **启动服务器**
   ```bash
   poetry run modbus-server
   ```

2. **访问 Web 控制台**
   - 打开浏览器访问: http://localhost:8080
   - 切换到"统计信息"标签页

3. **生成测试数据**
   ```bash
   poetry run python test_client.py
   ```

4. **查看统计**
   - 刷新页面查看所有功能码的调用统计
   - 支持实时 WebSocket 更新

### API 端点

获取统计信息：
```bash
curl http://localhost:8080/api/stats
```

返回格式：
```json
{
    "total_requests": 70,
    "successful_requests": 70,
    "function_codes": {
        "FC01": 6,
        "FC02": 2,
        "FC03": 12,
        "FC04": 2,
        "FC05": 8,
        "FC06": 10,
        "FC07": 2,
        "FC08": 2,
        "FC11": 2,
        "FC12": 2,
        "FC15": 2,
        "FC16": 8,
        "FC17": 2,
        "FC20": 2,
        "FC21": 2,
        "FC22": 2,
        "FC23": 2,
        "FC24": 2
    }
}
```

### 修改的文件

1. **modbus_slave_full/web/static/app.js**
   - 添加功能码名称映射
   - 实现按编号排序
   - 添加空数据处理

2. **modbus_slave_full/web/static/style.css**
   - 添加表格包装器样式
   - 实现粘性表头
   - 优化悬停和隔行效果

3. **modbus_slave_full/web/static/index.html**
   - 添加表格包装器
   - 更新标题图标

### 测试验证

✅ 所有 18 个功能码都正确显示中文名称
✅ 表格正确排序（FC01, FC02, ..., FC24）
✅ 深色/浅色主题都显示正常
✅ WebSocket 实时更新工作正常
✅ 空数据时显示友好提示

### 界面预览

**统计信息页面**：
```
┌─────────────────────────────────────────┐
│  📊 功能码统计                          │
├─────────────────────┬───────────────────┤
│ 功能码              │ 调用次数          │
├─────────────────────┼───────────────────┤
│ FC01 - 读线圈       │ 6                 │
│ FC02 - 读离散输入   │ 2                 │
│ FC03 - 读保持寄存器 │ 12                │
│ FC04 - 读输入寄存器 │ 2                 │
│ FC05 - 写单个线圈   │ 8                 │
│ FC06 - 写单个寄存器 │ 10                │
│ FC07 - 读异常状态   │ 2                 │
│ FC08 - 诊断         │ 2                 │
│ FC11 - 获取通信事件计数器 │ 2           │
│ FC12 - 获取通信事件日志   │ 2           │
│ FC15 - 写多个线圈   │ 2                 │
│ FC16 - 写多个寄存器 │ 8                 │
│ FC17 - 报告从站ID   │ 2                 │
│ FC20 - 读文件记录   │ 2                 │
│ FC21 - 写文件记录   │ 2                 │
│ FC22 - 屏蔽写寄存器 │ 2                 │
│ FC23 - 读写多个寄存器 │ 2               │
│ FC24 - 读FIFO队列   │ 2                 │
└─────────────────────┴───────────────────┘
```

## 总结

Web 界面现在完整支持显示所有 18 个 Modbus 功能码，包括文件读取/写入等高级功能。界面美观、易用，支持实时更新。
